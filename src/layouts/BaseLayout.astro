---
export interface Props {
  title: string;
  seoTitle?: string;
  seoDescription?: string;
}

import '../styles/global.css';
import AdSenseHeader from '../components/AdSenseHeader.astro';

const { title, seoTitle, seoDescription } = Astro.props;
const displayTitle = seoTitle ? seoTitle.replace('%title%', title) : title;
const canonicalUrl = new URL(Astro.url.pathname, Astro.site).href;
---
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{displayTitle}</title>
  {seoDescription && <meta name="description" content={seoDescription} />}
  <link rel="canonical" href={canonicalUrl} />
  <link rel="icon" type="image/webp" sizes="32x32" href="/wp-content/uploads/2024/09/cropped-qwen-32x32.webp" />
  <link rel="icon" type="image/webp" sizes="192x192" href="/wp-content/uploads/2024/09/cropped-qwen-192x192.webp" />
  <link rel="apple-touch-icon" href="/wp-content/uploads/2024/09/cropped-qwen-180x180.webp" />
  <meta name="robots" content="index, follow" />
  <meta name="google-site-verification" content="fqVPifZzIzVQVICweVlgOWCs2eZnP663vzjh0KRvzro" />
  <!-- Preconnect para Google AdSense (prepara conexión mientras carga la página) -->
  <link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin />
  <link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin />
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <a href="/" class="site-logo">
        <img src="/wp-content/uploads/2024/09/cropped-Qwen-AI.webp" alt="Qwen AI" width="150" height="50" />
      </a>
      <button class="mobile-menu-toggle" aria-label="Toggle menu" id="mobileMenuToggle">
        <span></span><span></span><span></span>
      </button>
      <nav class="main-nav" id="mainNav">
        <a href="/qwen-3/">Qwen 3</a>
        <a href="/chat/">Chat</a>
        <a href="/blog/">Blog</a>
        <a href="/images/">Generate Images</a>
        <a href="/video/">Generate Videos</a>
        <a href="/voice-video-chat/">Voice & Video Chat</a>
        <a href="/prompts/">Prompts</a>
      </nav>
    </div>
  </header>

  <!-- Ad Slot 1: Below header, above content -->
  <AdSenseHeader />

  <main class="qwen-page-wrapper">
    <slot />
  </main>

  <footer class="site-footer">
    <div class="footer-inner">
      <p>&copy; 2026 qwen-ai.com | This website is purely informational and is managed by enthusiasts of artificial intelligence. We are not the official site for any AI product, nor do we sell any AI-related products.</p>
      <p class="footer-links">
        <a href="/privacy-policy/">Privacy Policy</a> | <a href="/terms-of-service/">Terms of Service</a>
      </p>
    </div>
  </footer>

  <a href="#" class="back-to-top" id="backToTop" aria-label="Back to top">&#8679;</a>

  <script is:inline>
    // Mobile menu toggle
    var toggle = document.getElementById('mobileMenuToggle');
    var nav = document.getElementById('mainNav');
    if (toggle && nav) {
      toggle.addEventListener('click', function() {
        nav.classList.toggle('open');
        toggle.classList.toggle('open');
      });
    }
    // Back to top
    var btn = document.getElementById('backToTop');
    if (btn) {
      window.addEventListener('scroll', function() {
        btn.style.display = window.scrollY > 300 ? 'flex' : 'none';
      });
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    }
  </script>

  <!-- AdSense: Carga diferida para mejorar rendimiento -->
  <script is:inline>
    // Cargar AdSense después de que la página esté lista
    function loadAdSense() {
      // Ad Slot 2: Inyectar después del primer <p> en article ANTES de cargar AdSense
      (function() {
        var article = document.querySelector('article.qwen-container');
        if (article) {
          var firstP = article.querySelector('p');
          if (firstP) {
            var adSlot = document.createElement('div');
            adSlot.className = 'ad-afterintro-container';
            adSlot.innerHTML = '<div class="ad-afterintro-inner"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9609544329602409" data-ad-slot="8310388095" data-ad-format="auto" data-full-width-responsive="true"></ins></div>';
            firstP.parentNode.insertBefore(adSlot, firstP.nextSibling);
          }
        }
      })();

      // Crear y cargar el script de AdSense
      var script = document.createElement('script');
      script.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9609544329602409';
      script.async = true;
      script.crossOrigin = 'anonymous';
      script.onload = function() {
        // Inicializar los anuncios cuando el script esté cargado
        // Buscar todos los bloques de anuncios y hacer push para cada uno
        try {
          var ads = document.querySelectorAll('.adsbygoogle');
          for (var i = 0; i < ads.length; i++) {
            (adsbygoogle = window.adsbygoogle || []).push({});
          }
        } catch (e) {}
      };
      document.head.appendChild(script);
    }

    // Cargar después de que la página termine de renderizar
    if (document.readyState === 'complete') {
      loadAdSense();
    } else {
      window.addEventListener('load', loadAdSense);
    }
  </script>
</body>
</html>
